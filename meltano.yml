version: 1
send_anonymous_usage_stats: false
default_environment: dev
project_id: tap-suiteq
plugins:
  extractors:
  - name: tap-suiteql
    namespace: tap_suiteql
    pip_url: -e .
    capabilities:
    - properties
    - state
    - catalog
    - discover
    settings:
    - name: account_id
      env: TAP_SUITEQL_ACCOUNT_ID
    - name: consumer_key
      env: TAP_SUITEQL_CONSUMER_KEY
    - name: consumer_secret
      env: TAP_SUITEQL_CONSUMER_SECRET
    - name: token_id
      env: TAP_SUITEQL_TOKEN_ID
    - name: token_secret
      env: TAP_SUITEQL_TOKEN_SECRET
    - name: base_url
      env: TAP_SUITEQL_BASE_URL
    - name: start_date
      env: TAP_SUITEQL_START_DATE
  loaders:
  - name: target-jsonl
    variant: andyh1203
    pip_url: target-jsonl
  mapper:
  - name: meltano-map-transformer
    pip_url: "git+https://github.com/MeltanoLabs/meltano-map-transform.git"
    executable: meltano-map-transform
    mappings:
    - name: update_ids
      config:
        stream_maps:
          account:
            id: int(id)
            _fivetran_deleted: "true if _sdc_deleted_at is not null else false"
            __alias__: accounts
            hash_id: md5(str(id))
            __key_properties__: ["hash_id"]
environments:
  - name: dev
    config:
      plugins:
        extractors:
          - name: tap-suiteql
            namespace: netsuite
            pip_url: -e .
            capabilities:
            - properties
            - state
            - catalog
            - discover
            settings:
            - name: account_id
              env: TAP_SUITEQL_ACCOUNT_ID
            - name: consumer_key
              env: TAP_SUITEQL_CONSUMER_KEY
            - name: consumer_secret
              env: TAP_SUITEQL_CONSUMER_SECRET
            - name: token_id
              env: TAP_SUITEQL_TOKEN_ID
            - name: token_secret
              env: TAP_SUITEQL_TOKEN_SECRET
            - name: base_url
              env: TAP_SUITEQL_BASE_URL
            - name: start_date
              env: TAP_SUITEQL_START_DATE
            select:
              - account.*
              - "!trans*.*_url"
            metadata:
              account:
                replication-method: FULL_TABLE
                replication-key: id
              customer:
                replication-method: INCREMENTAL
              "*":
                replication-method: INCREMENTAL
              "*_full":
                replication-method: FULL_TABLE
            mappings:
            - name: update_ids
              config:
                stream_maps:
                  account:
                    id: int(id)
                    _fivetran_deleted: "true if _sdc_deleted_at is not null else false"
                    __alias__: accounts
                    hash_id: md5(str(id))
                    __key_properties__: ["hash_id"]
  - name: staging
  - name: prod